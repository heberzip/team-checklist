<section class="section-container">
  <chl-item-form
    [visible]="showItemDialog()"
    (visibleChange)="showItemDialog.set($event)"
    [item]="editingItem()"
    (save)="onDialogSave($event)"
    (cancel)="onDialogCancel()"
  >
  </chl-item-form>
  <div
    class="flex flex-col sm:flex-row items-start gap-6 sm:gap-0 sm:items-center justify-between"
  >
    <div class="inline-flex gap-6">
      <p-button
        icon="pi pi-chevron-left"
        (click)="goBack()"
        [styleClass]="
          [
            pIconBtnSty().base,
            pIconBtnSty().rounded.base,
            pIconBtnSty().rounded.variants['zt-primary']
          ].join(' ')
        "
      />
      <h2 class="section-title">{{ chlData?.title | uppercase }}</h2>
    </div>
    <p-button
      label="Añadir ítem"
      (click)="goNew()"
      [styleClass]="
        [pBtnSty().base, pBtnSty().variants['zt-success']].join(' ')
      "
    />
  </div>

  <p class="text-lg font-semibold">{{ chlData?.description }}</p>

  <div id="progress">
    Completado {{ progressLbl() }} --- {{ progressPct() }}%
  </div>

  @if (itmSgn().length) {
  <ul class="item-list flex flex-col gap-2">
    @for (i of itmSgn(); track i?.id ?? $index) {
    <li class="flex items-center gap-4 py-3 px-6 shadow-md rounded-lg">
      <label class="flex items-center space-x-4 flex-1">
        <input
          type="checkbox"
          [checked]="i.done"
          (change)="toggleDone(i, $event.target.checked)"
          class="size-[15px] rounded border border-primary-400 accent-primary-500 hover:border-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-secondary-500 focus-visible:outline-rounded disabled:opacity-50"
        />
        <span
          [class.done]="i.done"
          class="font-semibold text-lg text-neutral-700"
          >{{ i.text }}</span
        >
      </label>
      <div class="flex items-center gap-1">
        <p-button
          icon="pi pi-pencil"
          (click)="goEdit(i.id)"
          [styleClass]="
            [
              pIconBtnSty().base,
              pIconBtnSty().square.base,
              pIconBtnSty().square.variants['zt-success']
            ].join(' ')
          "
        />
        <p-button
          icon="pi pi-trash"
          (click)="delete(chlId(), i.id)"
          [styleClass]="
            [
              pIconBtnSty().base,
              pIconBtnSty().square.base,
              pIconBtnSty().square.variants['zt-error']
            ].join(' ')
          "
        />
      </div>
    </li>
    }
  </ul>
  } @else {
  <p>Sin ítems.</p>
  }
</section>
